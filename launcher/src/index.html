<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Retreivr Launcher</title>
    <link rel="stylesheet" href="./styles.css" />
  </head>
  <body>
    <main class="shell">
      <header class="header">
        <div class="brand-row">
          <img class="retreivr-mark" src="./assets/retreivr_mark.png" alt="Retreivr" />
          <div class="brand-copy">
            <h1>Retreivr Launcher</h1>
            <p class="subtitle">Guided setup and runtime control for local Retreivr on Docker.</p>
          </div>
          <img class="sudostacks-mark" src="./assets/sudostacks.png" alt="SudoStacks" />
        </div>
      </header>

      <section class="card">
        <h2>First-Run Checklist</h2>
        <p id="onboardingSummary" class="status">Checking onboarding readiness...</p>
        <ul id="onboardingList" class="checklist"></ul>
      </section>

      <section class="card">
        <h2>Updates</h2>
        <div class="updates-grid">
          <p>Launcher version: <strong id="launcherVersion">...</strong></p>
          <p>Latest launcher: <strong id="launcherLatest">...</strong></p>
          <p>Retreivr image: <strong id="retreivrImage">...</strong></p>
          <p>Image update: <strong id="retreivrImageUpdate">Unknown</strong></p>
        </div>
        <div class="actions-row">
          <button id="checkLauncherUpdateBtn" type="button">Check Launcher Update</button>
          <button id="downloadLauncherUpdateBtn" type="button">Download Launcher Update</button>
          <button id="checkImageUpdateBtn" type="button">Check Image Update</button>
          <button id="updateRestartBtn" type="button">Update + Restart</button>
        </div>
      </section>

      <section class="card">
        <h2>Step 1: System Check</h2>
        <div class="diag-grid">
          <p>Docker installed: <strong id="diagDockerInstalled">...</strong></p>
          <p>Docker running: <strong id="diagDockerRunning">...</strong></p>
          <p>Compose available: <strong id="diagComposeAvailable">...</strong></p>
          <p>Compose file: <strong id="diagComposeExists">...</strong></p>
          <p>Container: <strong id="diagContainerRunning">...</strong></p>
          <p>Web reachable: <strong id="diagWebReachable">...</strong></p>
        </div>
        <p id="diagError" class="diag-error"></p>
        <button id="refreshBtn" type="button">Refresh Status</button>
      </section>

      <section id="dockerGuideCard" class="card hidden">
        <h2 id="guideTitle">Docker Guidance</h2>
        <p id="guideSummary"></p>
        <ul id="guideSteps" class="guide-steps"></ul>
        <div class="actions-row">
          <button id="openDockerInstall" type="button">Open Docker Download</button>
          <button id="recheckDocker" type="button">Recheck Docker</button>
        </div>
      </section>

      <section class="card">
        <h2>Step 2: Configuration</h2>
        <form id="settingsForm" class="form-grid">
          <label for="presetSelect">Quick Preset</label>
          <div class="preset-row">
            <select id="presetSelect" name="presetSelect">
              <option value="standard">Standard Local (8090, stable)</option>
              <option value="alt_port">Alt Port (9000, stable)</option>
              <option value="edge">Edge Build (8090, edge)</option>
            </select>
            <button id="applyPresetBtn" type="button">Apply Preset</button>
          </div>

          <label for="hostPort">Host Port</label>
          <input id="hostPort" name="hostPort" type="number" min="1" max="65535" required />

          <label for="image">Image</label>
          <input id="image" name="image" type="text" required />

          <label for="containerName">Container Name</label>
          <input id="containerName" name="containerName" type="text" required />

          <label for="downloadsDir">Downloads Folder</label>
          <div class="path-row">
            <input id="downloadsDir" name="downloadsDir" type="text" required />
            <button id="browseDownloadsDirBtn" type="button">Browse</button>
          </div>

          <label for="configDir">Config Folder</label>
          <div class="path-row">
            <input id="configDir" name="configDir" type="text" required />
            <button id="browseConfigDirBtn" type="button">Browse</button>
          </div>

          <label for="tokensDir">Tokens Folder</label>
          <div class="path-row">
            <input id="tokensDir" name="tokensDir" type="text" required />
            <button id="browseTokensDirBtn" type="button">Browse</button>
          </div>

          <label for="logsDir">Logs Folder</label>
          <div class="path-row">
            <input id="logsDir" name="logsDir" type="text" required />
            <button id="browseLogsDirBtn" type="button">Browse</button>
          </div>

          <label for="dataDir">Data Folder</label>
          <div class="path-row">
            <input id="dataDir" name="dataDir" type="text" required />
            <button id="browseDataDirBtn" type="button">Browse</button>
          </div>

          <div class="actions-row">
            <button id="saveBtn" type="submit">Save Configuration</button>
            <button id="resetBtn" type="button">Reset Defaults</button>
          </div>
        </form>
      </section>

      <section class="card controls">
        <h2>Step 3: Runtime</h2>
        <div class="actions-row">
          <button id="installBtn" type="button">Start Retreivr</button>
          <button id="stopBtn" type="button">Stop Retreivr</button>
          <button id="openUI" type="button">Open Web UI</button>
          <button id="openDataFolderBtn" type="button">Open Data Folder</button>
          <button id="openComposeFolderBtn" type="button">Open Compose Folder</button>
          <button id="viewLogsBtn" type="button">View Logs</button>
          <button id="copyDiagBtn" type="button">Copy Diagnostics</button>
        </div>
        <p id="preflightSummary" class="status"></p>
        <ul id="preflightChecks" class="checklist"></ul>
      </section>

      <section id="errorPanel" class="card hidden">
        <h2 id="errorTitle">Issue</h2>
        <p id="errorMessage"></p>
        <ul id="errorFixes" class="guide-steps"></ul>
      </section>

      <section id="logsPanel" class="card hidden">
        <h2>Retreivr Logs</h2>
        <pre id="logsOutput" class="logs-output"></pre>
      </section>

      <section class="card">
        <p id="summary">Loading launcher state...</p>
        <p id="composePath"></p>
        <p id="runtimeDir"></p>
        <p id="status" class="status">Initializing...</p>
      </section>
    </main>
    <script type="module" src="./main.js"></script>
  </body>
</html>
